[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Visual Analytics of Worldwide Suicide Rate",
    "section": "",
    "text": "Suicide is recognised as a public health priority by the World Health Organisation, as over 700,000 people die annually due to suicide . It is a problem that is not unique to high-income countries (where there is a well-established link with mental disorders) but also affects low- and middle-income countries (where many suicides happen impulsively in moments of crisis with a breakdown in the ability to deal with life stresses). Suicide mortality rate is one of the indicators of target 3.4 of the Sustainable Development Goals: by 2030, which is to reduce by one third premature mortality from noncommunicable diseases."
  },
  {
    "objectID": "Proposal/ProposalPage.html",
    "href": "Proposal/ProposalPage.html",
    "title": "Project Proposal",
    "section": "",
    "text": "Exploring the relationship of suicide with potential drivers to reduce suicide rates.\n\n\nSuicide is recognised as a public health priority by the World Health Organisation1, as over 700,000 people die annually due to suicide . It is a problem that is not unique to high-income countries (where there is a well-established link with mental disorders) but also affects low- and middle-income countries (where many suicides happen impulsively in moments of crisis with a breakdown in the ability to deal with life stresses). Suicide mortality rate is one of the indicators of target 3.4 of the Sustainable Development Goals: by 2030, which is to reduce by one third premature mortality from noncommunicable diseases.\n\n\n\nOur World in Data 20152 collates global suicide-related data from various sources to contribute to an informed, open debate about ways to prevent suicides. Analysis of the data through unsupervised machine learning techniques such as clustering and regression will allow for more actionable and meaningful insights to be drawn, which could ultimately contribute to timely, evidence-based suicide prevention programmes.\n\n\n\nThe project aims to deliver an R-Shiny app that provides interactive user interface design to:\n• Analyse global differences and patterns in suicide-related mortality rates across countries, age groups, gender, and time using Time Series Clustering\n• Identify important factors driving suicide-related mortality rates using Panel Data Regression\n\n\n\nThe main data on suicide rate is obtained from Global Burden of Disease Collaborative Network (IHME 20193) as it provides comprehensive suicide statistics based on country, year, gender, and age. However, since the purpose of the project is to uncover patterns, indicators (i.e., social and economic) and risk factors (i.e., homicide, violence and drug abuse) affecting suicide rate, additional dataset from World Health Organization4, World Bank and United Nations will also be used.\n\n\n\n\nConfirm the selection of appropriate indicators and risk factors associated with suicide rate\nData wrangling by cleaning and joining with other dataset by country and year\nPerform Exploratory Data Analysis using appropriate R packages\nAnalyse the data using Time Series Clustering using appropriate R packages\nAnalyse the data using Panel Data Regression using appropriate R packages\nModel validation and selection of Panel Data Regression\nDevelop R-Shiny app to enhance user interaction\n\nThe project milestone and timeline for the project is shown below:"
  },
  {
    "objectID": "DataPrep/DataPrep.html",
    "href": "DataPrep/DataPrep.html",
    "title": "Data Preparation",
    "section": "",
<<<<<<< HEAD
    "text": "pacman::p_load(\"tmap\", \"tidyverse\")\n\n\n\n\n\nsuicidedata <- list.files(path = \"data\",\n                          pattern = \"IHME-GBD_2019_DATA\",\n                          full.names = TRUE) %>%\n  lapply(read_csv) %>%\n  bind_rows\n\nworld_region <- read_csv(\"data/world-regions-according-to-the-world-bank.csv\")\n\n\nstr(suicidedata)\n\nspc_tbl_ [2,864,160 × 16] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ measure_id   : num [1:2864160] 1 1 1 1 1 1 1 1 1 1 ...\n $ measure_name : chr [1:2864160] \"Deaths\" \"Deaths\" \"Deaths\" \"Deaths\" ...\n $ location_id  : num [1:2864160] 34 34 34 34 34 34 34 34 34 34 ...\n $ location_name: chr [1:2864160] \"Azerbaijan\" \"Azerbaijan\" \"Azerbaijan\" \"Azerbaijan\" ...\n $ sex_id       : num [1:2864160] 1 2 3 1 2 3 1 2 3 1 ...\n $ sex_name     : chr [1:2864160] \"Male\" \"Female\" \"Both\" \"Male\" ...\n $ age_id       : num [1:2864160] 7 7 7 7 7 7 7 7 7 8 ...\n $ age_name     : chr [1:2864160] \"10-14 years\" \"10-14 years\" \"10-14 years\" \"10-14 years\" ...\n $ cause_id     : num [1:2864160] 718 718 718 718 718 718 718 718 718 718 ...\n $ cause_name   : chr [1:2864160] \"Self-harm\" \"Self-harm\" \"Self-harm\" \"Self-harm\" ...\n $ metric_id    : num [1:2864160] 1 1 1 2 2 2 3 3 3 1 ...\n $ metric_name  : chr [1:2864160] \"Number\" \"Number\" \"Number\" \"Percent\" ...\n $ year         : num [1:2864160] 1990 1990 1990 1990 1990 1990 1990 1990 1990 1990 ...\n $ val          : num [1:2864160] 2.12717 0.73168 2.85886 0.00936 0.00519 ...\n $ upper        : num [1:2864160] 5.06912 1.12527 6.00823 0.02232 0.00788 ...\n $ lower        : num [1:2864160] 1.20028 0.46192 1.80284 0.00534 0.00324 ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   measure_id = col_double(),\n  ..   measure_name = col_character(),\n  ..   location_id = col_double(),\n  ..   location_name = col_character(),\n  ..   sex_id = col_double(),\n  ..   sex_name = col_character(),\n  ..   age_id = col_double(),\n  ..   age_name = col_character(),\n  ..   cause_id = col_double(),\n  ..   cause_name = col_character(),\n  ..   metric_id = col_double(),\n  ..   metric_name = col_character(),\n  ..   year = col_double(),\n  ..   val = col_double(),\n  ..   upper = col_double(),\n  ..   lower = col_double()\n  .. )\n - attr(*, \"problems\")=<externalptr> \n\n\n\n\n\n\nFilter for “Self-harm”\nSelect relevant columns and arrange rows based on location_name\nPivot_wider by metric_name (number, percent, and rate)\nCalculate the population size, death number and death rate\n\n\nsuicidedata_mod <- suicidedata %>%\n  filter(cause_name == \"Self-harm\") %>%\n  arrange(location_name) %>%\n  select(4,6,8,10,(12:14)) %>%\n  pivot_wider(names_from = metric_name, values_from = val, names_glue = \"suicide_{metric_name}\") %>%\n  mutate(population_size = suicide_Number/(suicide_Rate/100000),\n         death_number = suicide_Number/suicide_Percent,\n         death_rate = death_number/population_size*100000,\n         year = as.integer(year))\n\nsuicidedata_mod\n\n# A tibble: 330,480 × 11\n   locat…¹ sex_n…² age_n…³ cause…⁴  year suici…⁵ suici…⁶ suici…⁷ popul…⁸ death…⁹\n   <chr>   <chr>   <chr>   <chr>   <int>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n 1 Afghan… Male    10-14 … Self-h…  1991   10.5  0.00830   1.43   7.33e5   1260.\n 2 Afghan… Female  10-14 … Self-h…  1991    1.97 0.00174   0.281  7.02e5   1135.\n 3 Afghan… Both    10-14 … Self-h…  1991   12.4  0.00519   0.866  1.43e6   2395.\n 4 Afghan… Male    15-19 … Self-h…  1991   43.4  0.0194    5.49   7.91e5   2243.\n 5 Afghan… Female  15-19 … Self-h…  1991   36.2  0.0216    4.87   7.43e5   1675.\n 6 Afghan… Both    15-19 … Self-h…  1991   79.6  0.0203    5.19   1.53e6   3917.\n 7 Afghan… Male    20-24 … Self-h…  1991   60.9  0.0250    9.58   6.36e5   2432.\n 8 Afghan… Female  20-24 … Self-h…  1991   68.4  0.0320   10.7    6.41e5   2136.\n 9 Afghan… Both    20-24 … Self-h…  1991  129.   0.0283   10.1    1.28e6   4567.\n10 Afghan… Male    25-29 … Self-h…  1991   34.8  0.0246    9.57   3.64e5   1414.\n# … with 330,470 more rows, 1 more variable: death_rate <dbl>, and abbreviated\n#   variable names ¹​location_name, ²​sex_name, ³​age_name, ⁴​cause_name,\n#   ⁵​suicide_Number, ⁶​suicide_Percent, ⁷​suicide_Rate, ⁸​population_size,\n#   ⁹​death_number\n\n\n\n\n\ndata)\nIdentify key differences\n\nsuicide_vs_region <- setdiff(suicidedata_mod$location_name, world_region$Entity) %>%\n  enframe(name = NULL, value = \"desn\") %>% \n  arrange(desn)\n\n\n#the list of countries in suicidedata_clean but not in world_map\nsuicide_vs_region  %>% \n  knitr::kable(caption = \"Countries in suicide dataset vs. ISO3 regions: Coverage diff\",\n               row.names = TRUE)\n\n\nCountries in suicide dataset vs. ISO3 regions: Coverage diff\n\n\n\ndesn\n\n\n\n\n1\nBolivia (Plurinational State of)\n\n\n2\nBrunei Darussalam\n\n\n3\nCabo Verde\n\n\n4\nCôte d’Ivoire\n\n\n5\nDemocratic People’s Republic of Korea\n\n\n6\nDemocratic Republic of the Congo\n\n\n7\nIran (Islamic Republic of)\n\n\n8\nLao People’s Democratic Republic\n\n\n9\nMicronesia (Federated States of)\n\n\n10\nRepublic of Korea\n\n\n11\nRepublic of Moldova\n\n\n12\nRussian Federation\n\n\n13\nSyrian Arab Republic\n\n\n14\nTaiwan (Province of China)\n\n\n15\nTimor-Leste\n\n\n16\nUnited Republic of Tanzania\n\n\n17\nUnited States of America\n\n\n18\nVenezuela (Bolivarian Republic of)\n\n\n19\nViet Nam\n\n\n\n\n\n\n\nChange the names of countries to match the two datasets\n\nsuicidedata_cln_ctry <- suicidedata_mod %>%\n  rename(country = location_name) %>%\n  mutate(country = case_when(country == \"Bolivia (Plurinational State of)\" ~ \"Bolivia\",\n                             country == \"Brunei Darussalam\" ~ \"Brunei\",\n                             country == \"Cabo Verde\" ~ \"Cape Verde\",\n                             country == \"Côte d'Ivoire\" ~ \"Cote d'Ivoire\",\n                             country == \"Democratic People's Republic of Korea\" ~ \"North Korea\",\n                             country == \"Democratic Republic of the Congo\" ~ \"Democratic Republic of Congo\",\n                             country == \"Iran (Islamic Republic of)\" ~ \"Iran\",\n                             country == \"Lao People's Democratic Republic\" ~ \"Laos\",\n                             country == \"Micronesia (Federated States of)\" ~ \"Micronesia\",\n                             country == \"Republic of Korea\" ~ \"South Korea\",\n                             country == \"Republic of Moldova\" ~ \"Moldova\",\n                             country == \"Russian Federation\" ~ \"Russia\",\n                             country == \"Syrian Arab Republic\" ~ \"Syria\",\n                             country == \"Taiwan (Province of China)\" ~ \"Taiwan\",\n                             country == \"United Republic of Tanzania\" ~ \"Tanzania\",\n                             country == \"Venezuela (Bolivarian Republic of)\" ~ \"Venezuela\",\n                             country == \"Viet Nam\" ~ \"Vietnam\",\n                             TRUE ~ country))\n\nworld_region_cln <- world_region %>%\n  rename(country = Entity) %>%\n  mutate(country = case_when(country == \"Timor\" ~ \"Timor-Leste\",\n                             country == \"United States\" ~ \"United States of America\",\n                             TRUE~country))\n\n### Progress check\nsetdiff(suicidedata_cln_ctry$country, world_region_cln$country)  %>% \n  enframe(name = NULL, value = \"diff\") %>% \n  knitr::kable(caption = \"Remaining Cases\", \n               row.names = TRUE)\n\n\nRemaining Cases\n\n\n\ndiff\n\n\n\n\n\n\n\nJoining the two datasets\n\nsuicidedata_cln = suicidedata_cln_ctry %>%\n  left_join(world_region_cln, by = c('country' = 'country')) %>%\n  select(!Year) %>%\n  rename(code = Code,\n         region = World_RegionbyWorld_Bank) %>%\n  relocate(code:region, .after = country)\n\nsuicidedata_cln\n\n# A tibble: 330,480 × 13\n   country    code  region sex_n…¹ age_n…² cause…³  year suici…⁴ suici…⁵ suici…⁶\n   <chr>      <chr> <chr>  <chr>   <chr>   <chr>   <int>   <dbl>   <dbl>   <dbl>\n 1 Afghanist… AFG   South… Male    10-14 … Self-h…  1991   10.5  0.00830   1.43 \n 2 Afghanist… AFG   South… Female  10-14 … Self-h…  1991    1.97 0.00174   0.281\n 3 Afghanist… AFG   South… Both    10-14 … Self-h…  1991   12.4  0.00519   0.866\n 4 Afghanist… AFG   South… Male    15-19 … Self-h…  1991   43.4  0.0194    5.49 \n 5 Afghanist… AFG   South… Female  15-19 … Self-h…  1991   36.2  0.0216    4.87 \n 6 Afghanist… AFG   South… Both    15-19 … Self-h…  1991   79.6  0.0203    5.19 \n 7 Afghanist… AFG   South… Male    20-24 … Self-h…  1991   60.9  0.0250    9.58 \n 8 Afghanist… AFG   South… Female  20-24 … Self-h…  1991   68.4  0.0320   10.7  \n 9 Afghanist… AFG   South… Both    20-24 … Self-h…  1991  129.   0.0283   10.1  \n10 Afghanist… AFG   South… Male    25-29 … Self-h…  1991   34.8  0.0246    9.57 \n# … with 330,470 more rows, 3 more variables: population_size <dbl>,\n#   death_number <dbl>, death_rate <dbl>, and abbreviated variable names\n#   ¹​sex_name, ²​age_name, ³​cause_name, ⁴​suicide_Number, ⁵​suicide_Percent,\n#   ⁶​suicide_Rate\n\n\n\n\n\n\nRisk Factors of Suicide\n\n\n\nRisk Factors of Suicide\n\n\n\n\n\nsuicidedata_age_std <- suicidedata_cln %>%\n  filter(age_name == \"Age-standardized\") %>%\n  pivot_wider(names_from = sex_name,\n              values_from = suicide_Rate) %>%\n  select(c(1,2,3,6,12,13,14)) %>%\n  rename(\"SR_AS_T\" = \"Both\",\n         \"SR_AS_M\" = \"Male\",\n         \"SR_AS_F\" = \"Female\")\n\n\n\n\n\n\nSource for division https://www.ncbi.nlm.nih.gov/books/NBK470850/figure/SR-240_RB-3370.fig08/\n\n10 to 14\n15 to 24\n25 to 44\n45 to 64\n65 to 74\n75+\n\n\nsuicide_number_age <- suicidedata_cln %>%\n  filter(!age_name %in% c(\"Age-standardized\")) %>%\n  select(c(2,4,5,7,8)) %>%\n  mutate(age_name = str_remove(age_name, \" years\"),\n         age_name = str_remove(age_name, \" ages\"),\n         sex_name = case_when(sex_name == \"Male\" ~ \"M\",\n                              sex_name == \"Female\" ~ \"F\",\n                              sex_name == \"Both\" ~ \"T\",\n                              TRUE ~ sex_name)) %>%\n  pivot_wider(names_from = c(age_name, sex_name),\n              names_prefix = \"SN_\",\n              values_from = suicide_Number) %>%\n  mutate(`SN_15-24_M` = `SN_15-19_M`+`SN_20-24_M`,\n         `SN_15-24_F` = `SN_15-19_F`+`SN_20-24_F`,\n         `SN_15-24_T` = `SN_15-19_T`+`SN_20-24_T`,\n         `SN_25-44_M` = `SN_25-29_M`+`SN_30-34_M`+`SN_35-39_M`+`SN_40-44_M`,\n         `SN_25-44_F` = `SN_25-29_F`+`SN_30-34_F`+`SN_35-39_F`+`SN_40-44_F`,\n         `SN_25-44_T` = `SN_25-29_T`+`SN_30-34_T`+`SN_35-39_T`+`SN_40-44_T`,\n         `SN_45-64_M` = `SN_45-49_M`+`SN_50-54_M`+`SN_55-59_M`+`SN_60-64_M`,\n         `SN_45-64_F` = `SN_45-49_F`+`SN_50-54_F`+`SN_55-59_F`+`SN_60-64_F`,\n         `SN_45-64_T` = `SN_45-49_T`+`SN_50-54_T`+`SN_55-59_T`+`SN_60-64_T`,\n         `SN_65-74_M` = `SN_65-69_M`+`SN_70-74_M`,\n         `SN_65-74_F` = `SN_65-69_F`+`SN_70-74_F`,\n         `SN_65-74_T` = `SN_65-69_T`+`SN_70-74_T`,\n         `SN_75+_M` = `SN_75-79_M`+`SN_80-84_M`+`SN_85+_M`,\n         `SN_75+_F` = `SN_75-79_F`+`SN_80-84_F`+`SN_85+_F`,\n         `SN_75+_T` = `SN_75-79_T`+`SN_80-84_T`+`SN_85+_T`) %>%\n  select(code:`SN_10-14_T`, `SN_15-24_M`:`SN_75+_T`, `SN_All_M`:`SN_All_T`)\n\n\n#suicide_number_age <- suicidedata_cln %>%\n#  filter(sex_name == \"Both\",\n#         !age_name %in% c(\"All ages\", \"Age-standardized\")) %>%\n#  select(c(2,5,7,8)) %>%\n#  pivot_wider(names_from = age_name,\n#              values_from = suicide_Number) %>%\n#  mutate(young_SN = rowSums(.[3:5]),\n#         econ_active_SN = rowSums(.[6:13]),\n#         aged_SN = rowSums(.[14:18]),\n#         total_SN = young_SN+econ_active_SN+aged_SN) %>%\n#  select(c(1,2,19,20,21,22))\n\n\n\n\n\npop_size_age <- suicidedata_cln %>%\n  filter(!age_name %in% c(\"Age-standardized\")) %>%\n  select(c(2,4,5,7,11)) %>%\n  mutate(age_name = str_remove(age_name, \" years\"),\n         age_name = str_remove(age_name, \" ages\"),\n         sex_name = case_when(sex_name == \"Male\" ~ \"M\",\n                              sex_name == \"Female\" ~ \"F\",\n                              sex_name == \"Both\" ~ \"T\",\n                              TRUE ~ sex_name)) %>%\n  pivot_wider(names_from = c(age_name, sex_name),\n              names_prefix = \"POP_\",\n              values_from = population_size) %>%\n  mutate(`POP_15-24_M` = `POP_15-19_M`+`POP_20-24_M`,\n         `POP_15-24_F` = `POP_15-19_F`+`POP_20-24_F`,\n         `POP_15-24_T` = `POP_15-19_T`+`POP_20-24_T`,\n         `POP_25-44_M` = `POP_25-29_M`+`POP_30-34_M`+`POP_35-39_M`+`POP_40-44_M`,\n         `POP_25-44_F` = `POP_25-29_F`+`POP_30-34_F`+`POP_35-39_F`+`POP_40-44_F`,\n         `POP_25-44_T` = `POP_25-29_T`+`POP_30-34_T`+`POP_35-39_T`+`POP_40-44_T`,\n         `POP_45-64_M` = `POP_45-49_M`+`POP_50-54_M`+`POP_55-59_M`+`POP_60-64_M`,\n         `POP_45-64_F` = `POP_45-49_F`+`POP_50-54_F`+`POP_55-59_F`+`POP_60-64_F`,\n         `POP_45-64_T` = `POP_45-49_T`+`POP_50-54_T`+`POP_55-59_T`+`POP_60-64_T`,\n         `POP_65-74_M` = `POP_65-69_M`+`POP_70-74_M`,\n         `POP_65-74_F` = `POP_65-69_F`+`POP_70-74_F`,\n         `POP_65-74_T` = `POP_65-69_T`+`POP_70-74_T`,\n         `POP_75+_M` = `POP_75-79_M`+`POP_80-84_M`+`POP_85+_M`,\n         `POP_75+_F` = `POP_75-79_F`+`POP_80-84_F`+`POP_85+_F`,\n         `POP_75+_T` = `POP_75-79_T`+`POP_80-84_T`+`POP_85+_T`) %>%\n  select(code:`POP_10-14_T`, `POP_15-24_M`:`POP_75+_T`, `POP_All_M`:`POP_All_T`)\n\n\n#pop_size_age <- suicidedata_cln %>%\n#  filter(sex_name == \"Both\",\n#         !age_name %in% c(\"All ages\", \"Age-standardized\")) %>%\n#  select(c(2,5,7,11)) %>%\n#  pivot_wider(names_from = age_name,\n#              values_from = population_size) %>%\n#  mutate(young_pop = rowSums(.[3:5]),\n#         econ_active_pop = rowSums(.[6:13]),\n#         aged_pop = rowSums(.[14:18]),\n#         total_pop = young_pop+econ_active_pop+aged_pop) %>%\n#  select(c(1,2,19,20,21,22))\n\n\n\n\n\ndeath_number_age <- suicidedata_cln %>%\n  filter(!age_name %in% c(\"Age-standardized\")) %>%\n  select(c(2,4,5,7,12)) %>%\n  mutate(age_name = str_remove(age_name, \" years\"),\n         age_name = str_remove(age_name, \" ages\"),\n         sex_name = case_when(sex_name == \"Male\" ~ \"M\",\n                              sex_name == \"Female\" ~ \"F\",\n                              sex_name == \"Both\" ~ \"T\",\n                              TRUE ~ sex_name)) %>%\n  pivot_wider(names_from = c(age_name, sex_name),\n              names_prefix = \"DN_\",\n              values_from = death_number) %>%\n  mutate(`DN_15-24_M` = `DN_15-19_M`+`DN_20-24_M`,\n         `DN_15-24_F` = `DN_15-19_F`+`DN_20-24_F`,\n         `DN_15-24_T` = `DN_15-19_T`+`DN_20-24_T`,\n         `DN_25-44_M` = `DN_25-29_M`+`DN_30-34_M`+`DN_35-39_M`+`DN_40-44_M`,\n         `DN_25-44_F` = `DN_25-29_F`+`DN_30-34_F`+`DN_35-39_F`+`DN_40-44_F`,\n         `DN_25-44_T` = `DN_25-29_T`+`DN_30-34_T`+`DN_35-39_T`+`DN_40-44_T`,\n         `DN_45-64_M` = `DN_45-49_M`+`DN_50-54_M`+`DN_55-59_M`+`DN_60-64_M`,\n         `DN_45-64_F` = `DN_45-49_F`+`DN_50-54_F`+`DN_55-59_F`+`DN_60-64_F`,\n         `DN_45-64_T` = `DN_45-49_T`+`DN_50-54_T`+`DN_55-59_T`+`DN_60-64_T`,\n         `DN_65-74_M` = `DN_65-69_M`+`DN_70-74_M`,\n         `DN_65-74_F` = `DN_65-69_F`+`DN_70-74_F`,\n         `DN_65-74_T` = `DN_65-69_T`+`DN_70-74_T`,\n         `DN_75+_M` = `DN_75-79_M`+`DN_80-84_M`+`DN_85+_M`,\n         `DN_75+_F` = `DN_75-79_F`+`DN_80-84_F`+`DN_85+_F`,\n         `DN_75+_T` = `DN_75-79_T`+`DN_80-84_T`+`DN_85+_T`) %>%\n  select(code:`DN_10-14_T`, `DN_15-24_M`:`DN_75+_T`, `DN_All_M`:`DN_All_T`)\n\n\n\n\n\nReference - https://ourworldindata.org/grapher/gdp-per-capita-worldbank?tab=chart\n\ngdp_per_capita <- read_csv(\"data/gdp-per-capita-worldbank.csv\")\n\n\ngdp_per_capita <- gdp_per_capita %>%\n  select(2,3,4) %>%\n  rename(\"code\" = \"Code\",\n         \"year\" = \"Year\",\n         \"gdp_per_capita\" = \"GDP per capita, PPP (constant 2017 international $)\") %>%\n  na.omit()\n\n\n\n\nReference - https://ourworldindata.org/grapher/human-development-index\n\nhdi <- read_csv(\"data/human-development-index.csv\")\n\n\nhdi <- hdi %>%\n  select(2,3,4) %>%\n  rename(\"code\" = \"Code\",\n         \"year\" = \"Year\",\n         \"hdi\" = \"Human Development Index\") %>%\n  na.omit()\n\n\n\n\nReference - https://ourworldindata.org/grapher/suicide-rates-vs-prevalence-of-depression\n\ndepr <- read_csv(\"data/suicide-rates-vs-prevalence-of-depression.csv\")\n\n\ndepr <- depr %>%\n  select(2,3,5) %>%\n  rename(\"code\" = \"Code\",\n         \"year\" = \"Year\",\n         \"depr_rate\" = \"Prevalence - Depressive disorders - Sex: Both - Age: Age-standardized (Rate)\") %>%\n  filter(year %in% (1990:2019)) %>%\n  na.omit()\n\n\n\n\nReference - https://ourworldindata.org/grapher/suicide-rate-vs-income-inequality\n\ngini <- read_csv(\"data/suicide-rate-vs-income-inequality.csv\")\n\n\ngini <- gini %>%\n  select(2,3,5) %>%\n  rename(\"code\" = \"Code\",\n         \"year\" = \"Year\",\n         \"gini\" = \"Gini coefficient\") %>%\n  filter(year %in% (1990:2019)) %>%\n  na.omit()\n\n\n\n\nReference - https://ourworldindata.org/grapher/suicide-vs-violent-deaths\n\nviolent <- read_csv(\"data/suicide-vs-violent-deaths.csv\")\n\n\nviolent <- violent %>%\n  select(2,3,5) %>%\n  rename(\"code\" = \"Code\",\n         \"year\" = \"Year\",\n         \"violent_death_rate\" = \"Deaths - All forms of violence - OWID - Sex: Both - Age: Age-standardized (Rate)\") %>%\n  filter(year %in% (1990:2019)) %>%\n  na.omit()\n\n\n\n\nReference - https://ourworldindata.org/grapher/share-of-population-in-extreme-poverty?country=BGD~BOL~MDG~IND~CHN~ETH\n\npoverty <- read_csv(\"data/share-of-population-in-extreme-poverty.csv\")\n\n\npoverty <- poverty %>%\n  select(2,3,4) %>%\n  rename(\"code\" = \"Code\",\n         \"year\" = \"Year\",\n         \"pop%extreme_poverty\" = \"$2.15 a day - share of population below poverty line\") %>%\n  filter(year %in% (1990:2019)) %>%\n  na.omit()\n\n\n\n\nReference - https://ourworldindata.org/grapher/unemployment-rate?time=latest\n\nunemployment <- read_csv(\"data/unemployment-rate.csv\")\n\n\nunemployment <- unemployment %>%\n  select(2,3,4) %>%\n  rename(\"code\" = \"Code\",\n         \"year\" = \"Year\",\n         \"unemployment_rate\" = \"Unemployment, total (% of total labor force) (modeled ILO estimate)\") %>%\n  filter(year %in% (1990:2019)) %>%\n  na.omit()\n\n\n\n\nReference - https://ourworldindata.org/grapher/haq-by-level-of-healthcare-spending-endpoints?time=earliest\n\nhealthcare <- read_csv(\"data/HAQ-by-level-of-healthcare-spending-endpoints.csv\")\n\n\nhealthcare <- healthcare %>%\n  select(2,3,4,5) %>%\n  rename(\"code\" = \"Code\",\n         \"year\" = \"Year\",\n         \"HAQ\" = \"HAQ Index (IHME (2017))\",\n         \"healthcare_spend\" = \"Current health expenditure per capita, PPP (current international $)\") %>%\n  filter(year %in% (1990:2019)) %>%\n  filter(!is.na(HAQ) | !is.na(healthcare_spend))\n\n\n\n\nReference - https://ourworldindata.org/grapher/happiness-cantril-ladder?time=latest\n\nhappiness <- read_csv(\"data/happiness-cantril-ladder.csv\")\n\n\nhappiness <- happiness %>%\n  select(2,3,4) %>%\n  rename(\"code\" = \"Code\",\n         \"year\" = \"Year\",\n         \"happiness\" = \"Life satisfaction in Cantril Ladder (World Happiness Report 2022)\") %>%\n  filter(year %in% (1990:2019)) %>%\n  na.omit()\n\n\n\n\nReference - https://ourworldindata.org/grapher/suicide-rates-vs-prevalence-of-mental-and-substance-use-disorders?time=latest\n\nmental <- read_csv(\"data/suicide-rates-vs-prevalence-of-mental-and-substance-use-disorders.csv\")\n\n\nmental <- mental %>%\n  select(2,3,5) %>%\n  rename(\"code\" = \"Code\",\n         \"year\" = \"Year\",\n         \"mental_disorder\" = \"Prevalence - Mental and substance use disorders - Sex: Both - Age: Age-standardized (Rate)\") %>%\n  filter(year %in% (1990:2019)) %>%\n  na.omit()\n\nFEEL FREE TO ADD SOMEMORE\n\n\n\n\nsuicidedata_eda_formap <- left_join(suicidedata_age_std, suicide_number_age, by = c('code' = 'code', 'year' = 'year')) %>% \n  \n  left_join(., pop_size_age, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  left_join(., death_number_age, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  #calculate suicide rate for each age group and gender\n  #Use Age Standardised for all age metrics\n  mutate(`SR_10-14_M` = `SN_10-14_M`*100000/`POP_10-14_M`,\n         `SR_10-14_F` = `SN_10-14_F`*100000/`POP_10-14_F`,\n         `SR_10-14_T` = `SN_10-14_T`*100000/`POP_10-14_T`,\n         `SR_15-24_M` = `SN_15-24_M`*100000/`POP_15-24_M`,\n         `SR_15-24_F` = `SN_15-24_F`*100000/`POP_15-24_F`,\n         `SR_15-24_T` = `SN_15-24_T`*100000/`POP_15-24_T`,\n         `SR_25-44_M` = `SN_25-44_M`*100000/`POP_25-44_M`,\n         `SR_25-44_F` = `SN_25-44_F`*100000/`POP_25-44_F`,\n         `SR_25-44_T` = `SN_25-44_T`*100000/`POP_25-44_T`,\n         `SR_45-64_M` = `SN_45-64_M`*100000/`POP_45-64_M`,\n         `SR_45-64_F` = `SN_45-64_F`*100000/`POP_45-64_F`,\n         `SR_45-64_T` = `SN_45-64_T`*100000/`POP_45-64_T`,\n         `SR_65-74_M` = `SN_65-74_M`*100000/`POP_65-74_M`,\n         `SR_65-74_F` = `SN_65-74_F`*100000/`POP_65-74_F`,\n         `SR_65-74_T` = `SN_65-74_T`*100000/`POP_65-74_T`,\n         `SR_75+_M` = `SN_75+_M`*100000/`POP_75+_M`,\n         `SR_75+_F` = `SN_75+_F`*100000/`POP_75+_F`,\n         `SR_75+_T` = `SN_75+_T`*100000/`POP_75+_T`) %>%\n    \n  #calculate suicide percent for each age group and gender\n    mutate(`SP_10-14_M` = `SN_10-14_M`*100/`DN_10-14_M`,\n         `SP_10-14_F` = `SN_10-14_F`*100/`DN_10-14_F`,\n         `SP_10-14_T` = `SN_10-14_T`*100/`DN_10-14_T`,\n         `SP_15-24_M` = `SN_15-24_M`*100/`DN_15-24_M`,\n         `SP_15-24_F` = `SN_15-24_F`*100/`DN_15-24_F`,\n         `SP_15-24_T` = `SN_15-24_T`*100/`DN_15-24_T`,\n         `SP_25-44_M` = `SN_25-44_M`*100/`DN_25-44_M`,\n         `SP_25-44_F` = `SN_25-44_F`*100/`DN_25-44_F`,\n         `SP_25-44_T` = `SN_25-44_T`*100/`DN_25-44_T`,\n         `SP_45-64_M` = `SN_45-64_M`*100/`DN_45-64_M`,\n         `SP_45-64_F` = `SN_45-64_F`*100/`DN_45-64_F`,\n         `SP_45-64_T` = `SN_45-64_T`*100/`DN_45-64_T`,\n         `SP_65-74_M` = `SN_65-74_M`*100/`DN_65-74_M`,\n         `SP_65-74_F` = `SN_65-74_F`*100/`DN_65-74_F`,\n         `SP_65-74_T` = `SN_65-74_T`*100/`DN_65-74_T`,\n         `SP_75+_M` = `SN_75+_M`*100/`DN_75+_M`,\n         `SP_75+_F` = `SN_75+_F`*100/`DN_75+_F`,\n         `SP_75+_T` = `SN_75+_T`*100/`DN_75+_T`,\n         `SP_All_M` = `SN_All_M`*100/`DN_All_M`,\n         `SP_All_F` = `SN_All_F`*100/`DN_All_F`,\n         `SP_All_T` = `SN_All_T`*100/`DN_All_T`) %>%\n  \n   arrange(code, year)\n\n\n\n\n\nsuicidedata_eda_temp <- suicidedata_cln %>%\n  select(!c(6,9,10,13)) %>%\n  mutate(age_name = str_remove(age_name, \" years\")) %>%\n  mutate(new_age_name = case_when(age_name %in% c(\"15-19\", \"20-24\") ~ \"15-24\",\n                                  age_name %in% c(\"25-29\", \"30-34\", \"35-39\", \"40-44\") ~ \"25-44\",\n                                  age_name %in% c(\"45-49\", \"50-54\", \"55-59\", \"60-64\") ~ \"45-64\",\n                                  age_name %in% c(\"65-69\", \"70-74\") ~ \"65-74\",\n                                  age_name %in% c(\"75-79\", \"80-84\", \"85+\") ~ \"75+\",\n                                  TRUE~age_name),\n         .after = age_name) %>%\n  group_by(country, code, region, sex_name, new_age_name, year) %>%\n  summarise(suicide_Number = sum(suicide_Number),\n            population_size = sum(population_size),\n            death_number = sum(death_number)) %>%\n  ungroup() %>%\n  \n  mutate(suicide_Percent = suicide_Number*100/death_number,\n         suicide_Rate = suicide_Number/population_size*100000,\n         death_rate = death_number/population_size*100000)\n\n\n  \nsd_as <-  suicidedata_cln %>%\n  filter(age_name == \"Age-standardized\") %>%\n  select(c(2,4,5,7,10))\n\n#Final EDA dataset\nsuicidedata_eda <- left_join(suicidedata_eda_temp, sd_as, by = c('code' = 'code', 'sex_name' = 'sex_name', 'new_age_name' = 'age_name', 'year' = 'year')) %>%\n  mutate(suicide_Rate = case_when(is.na(suicide_Rate.x) ~ suicide_Rate.y,\n                                  is.na(suicide_Rate.y) ~ suicide_Rate.x,\n                                  TRUE~suicide_Rate.x)) %>%\n  select(!c(11,13))\n\nknitr::kable(head(suicidedata_eda))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ncountry\ncode\nregion\nsex_name\nnew_age_name\nyear\nsuicide_Number\npopulation_size\ndeath_number\nsuicide_Percent\ndeath_rate\nsuicide_Rate\n\n\n\n\nAfghanistan\nAFG\nSouth Asia\nBoth\n10-14\n1990\n12.08308\n1388403\n2093.499\n0.5771713\n150.7847\n0.8702862\n\n\nAfghanistan\nAFG\nSouth Asia\nBoth\n10-14\n1991\n12.42996\n1434714\n2394.735\n0.5190537\n166.9137\n0.8663718\n\n\nAfghanistan\nAFG\nSouth Asia\nBoth\n10-14\n1992\n13.64449\n1553430\n2455.768\n0.5556098\n158.0868\n0.8783460\n\n\nAfghanistan\nAFG\nSouth Asia\nBoth\n10-14\n1993\n14.65760\n1650569\n2501.950\n0.5858470\n151.5810\n0.8880330\n\n\nAfghanistan\nAFG\nSouth Asia\nBoth\n10-14\n1994\n15.19196\n1720741\n2818.135\n0.5390784\n163.7745\n0.8828732\n\n\nAfghanistan\nAFG\nSouth Asia\nBoth\n10-14\n1995\n15.60024\n1803883\n2763.748\n0.5644595\n153.2111\n0.8648144\n\n\n\n\n\n\n\n\nFor analysis, we will only use suicide rate (SR)\n\nsuicidedata_analysis <- left_join(suicidedata_eda_formap %>%\n                                    select(country:`SR_AS_T`, `SR_10-14_M`:`SR_75+_T`,`POP_All_T`)\n                                    , gdp_per_capita, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  left_join(., hdi, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  left_join(., depr, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  left_join(., gini, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  left_join(., violent, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  left_join(., poverty, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  left_join(., unemployment, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  left_join(., healthcare, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  left_join(., happiness, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  left_join(., mental, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  arrange(code, year) %>%\n  \n  #infer HAQ data from previous survey year\n  group_by(code) %>%\n  fill(HAQ, .direction = \"down\") %>%\n  ungroup()\n\nknitr::kable(head(suicidedata_analysis))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ncountry\ncode\nregion\nyear\nSR_AS_M\nSR_AS_F\nSR_AS_T\nSR_10-14_M\nSR_10-14_F\nSR_10-14_T\nSR_15-24_M\nSR_15-24_F\nSR_15-24_T\nSR_25-44_M\nSR_25-44_F\nSR_25-44_T\nSR_45-64_M\nSR_45-64_F\nSR_45-64_T\nSR_65-74_M\nSR_65-74_F\nSR_65-74_T\nSR_75+_M\nSR_75+_F\nSR_75+_T\nPOP_All_T\ngdp_per_capita\nhdi\ndepr_rate\ngini\nviolent_death_rate\npop%extreme_poverty\nunemployment_rate\nHAQ\nhealthcare_spend\nhappiness\nmental_disorder\n\n\n\n\nAfghanistan\nAFG\nSouth Asia\n1990\n7.473870\n9.049445\n8.277699\n1.436904\n0.2845199\n0.8702862\n7.337760\n7.442836\n7.390589\n11.84758\n13.55788\n12.81545\n9.968172\n15.64862\n12.83096\n8.814404\n14.67018\n11.49686\n11.24017\n8.766798\n10.111531\n11418853\nNA\n0.273\n4996.12\nNA\n29.79\nNA\nNA\n24.7\nNA\nNA\n17415.21\n\n\nAfghanistan\nAFG\nSouth Asia\n1991\n7.365818\n8.956768\n8.174310\n1.426575\n0.2809178\n0.8663718\n7.312539\n7.557676\n7.433210\n11.48811\n13.40145\n12.55289\n9.861825\n15.51690\n12.72240\n8.700137\n14.54045\n11.37474\n11.10952\n8.685643\n10.000869\n12587130\nNA\n0.279\n4989.29\nNA\n46.43\nNA\n10.649\n24.7\nNA\nNA\n17691.57\n\n\nAfghanistan\nAFG\nSouth Asia\n1992\n7.311281\n8.949483\n8.139174\n1.441334\n0.2823200\n0.8783460\n7.416693\n7.846135\n7.622235\n11.18181\n13.34959\n12.35099\n9.815580\n15.51857\n12.71511\n8.642180\n14.52574\n11.33208\n11.03810\n8.651869\n9.944729\n14542839\nNA\n0.287\n4981.35\nNA\n48.07\nNA\n10.821\n24.7\nNA\nNA\n17939.24\n\n\nAfghanistan\nAFG\nSouth Asia\n1993\n7.367846\n9.075284\n8.231295\n1.456090\n0.2827438\n0.8880330\n7.619946\n8.151316\n7.870469\n11.12268\n13.50517\n12.37492\n9.906709\n15.74727\n12.90513\n8.680089\n14.64145\n11.40769\n11.03904\n8.672698\n9.953116\n15985046\nNA\n0.297\n4976.96\nNA\n43.19\nNA\n10.723\n24.7\nNA\nNA\n18134.24\n\n\nAfghanistan\nAFG\nSouth Asia\n1994\n7.476588\n9.215872\n8.362751\n1.450883\n0.2767099\n0.8828732\n7.800166\n8.235269\n8.004561\n11.22814\n13.68922\n12.49976\n10.066832\n16.05810\n13.19583\n8.767587\n14.81558\n11.54394\n11.08710\n8.707214\n9.993162\n16733617\nNA\n0.292\n4977.78\nNA\n71.25\nNA\n10.726\n24.7\nNA\nNA\n18261.32\n\n\nAfghanistan\nAFG\nSouth Asia\n1995\n7.511729\n9.265633\n8.408568\n1.424181\n0.2675633\n0.8648144\n7.869979\n8.231410\n8.039101\n11.25371\n13.73564\n12.52419\n10.094794\n16.18774\n13.29331\n8.786471\n14.90617\n11.60844\n11.06250\n8.696033\n9.971134\n17490181\nNA\n0.310\n4978.23\nNA\n50.07\nNA\n11.179\n24.5\nNA\nNA\n18309.33\n\n\n\n\n\n\n\n\n\nThe object World is a spatial object of class sf from the sf package; it is a data.frame with a special column that contains a geometry for each row, in this case polygons\nReference - https://cran.r-project.org/web/packages/tmap/vignettes/tmap-getstarted.html\n\ndata(\"World\")\n\nJoining the two dataframes together\n\nsuicidedata_eda_map <- left_join(World, \n                                  \n                                  #filter year 2015 for illustration\n                                   suicidedata_eda_formap %>% filter(year==2015),\n                          by = c(\"iso_a3\" = \"code\")) %>%\n  select(!c(2,3,4,6,7,8,9,10,11,12,13,14,15)) %>%\n  mutate(area = as.numeric(str_remove(`area`, \n                                \" \\\\[km\\\\^2\\\\]\")), \n         .after = region)\n\nknitr::kable(head(suicidedata_eda_map))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\niso_a3\narea\ncountry\nregion\nyear\nSR_AS_M\nSR_AS_F\nSR_AS_T\nSN_10-14_M\nSN_10-14_F\nSN_10-14_T\nSN_15-24_M\nSN_15-24_F\nSN_15-24_T\nSN_25-44_M\nSN_25-44_F\nSN_25-44_T\nSN_45-64_M\nSN_45-64_F\nSN_45-64_T\nSN_65-74_M\nSN_65-74_F\nSN_65-74_T\nSN_75+_M\nSN_75+_F\nSN_75+_T\nSN_All_M\nSN_All_F\nSN_All_T\nPOP_10-14_M\nPOP_10-14_F\nPOP_10-14_T\nPOP_15-24_M\nPOP_15-24_F\nPOP_15-24_T\nPOP_25-44_M\nPOP_25-44_F\nPOP_25-44_T\nPOP_45-64_M\nPOP_45-64_F\nPOP_45-64_T\nPOP_65-74_M\nPOP_65-74_F\nPOP_65-74_T\nPOP_75+_M\nPOP_75+_F\nPOP_75+_T\nPOP_All_M\nPOP_All_F\nPOP_All_T\nDN_10-14_M\nDN_10-14_F\nDN_10-14_T\nDN_15-24_M\nDN_15-24_F\nDN_15-24_T\nDN_25-44_M\nDN_25-44_F\nDN_25-44_T\nDN_45-64_M\nDN_45-64_F\nDN_45-64_T\nDN_65-74_M\nDN_65-74_F\nDN_65-74_T\nDN_75+_M\nDN_75+_F\nDN_75+_T\nDN_All_M\nDN_All_F\nDN_All_T\nSR_10-14_M\nSR_10-14_F\nSR_10-14_T\nSR_15-24_M\nSR_15-24_F\nSR_15-24_T\nSR_25-44_M\nSR_25-44_F\nSR_25-44_T\nSR_45-64_M\nSR_45-64_F\nSR_45-64_T\nSR_65-74_M\nSR_65-74_F\nSR_65-74_T\nSR_75+_M\nSR_75+_F\nSR_75+_T\nSP_10-14_M\nSP_10-14_F\nSP_10-14_T\nSP_15-24_M\nSP_15-24_F\nSP_15-24_T\nSP_25-44_M\nSP_25-44_F\nSP_25-44_T\nSP_45-64_M\nSP_45-64_F\nSP_45-64_T\nSP_65-74_M\nSP_65-74_F\nSP_65-74_T\nSP_75+_M\nSP_75+_F\nSP_75+_T\nSP_All_M\nSP_All_F\nSP_All_T\ngeometry\n\n\n\n\nAFG\n652860.00\nAfghanistan\nSouth Asia\n2015\n6.024135\n6.741279\n6.431005\n20.5227717\n3.5260647\n24.0488364\n203.67055\n169.119876\n372.79043\n376.72312\n328.75956\n705.48267\n112.12180\n179.11254\n291.23434\n16.476129\n33.5121907\n49.988319\n13.1995178\n10.364070\n23.563588\n742.7139\n724.39430\n1467.1082\n2306362.26\n2183941.69\n4490304.0\n3731529.9\n3533358.5\n7264888.4\n3784047.0\n3475662.2\n7259709.2\n1362286.6\n1434660.8\n2796947.4\n223149.79\n265143.12\n488292.91\n131334.416\n128583.555\n259917.97\n17206269\n16376997\n33583266\n2717.05506\n2386.18087\n5102.25422\n13286.1715\n6888.74363\n20168.5141\n19313.3988\n15170.4637\n34482.5598\n18784.581\n21837.915\n40626.606\n11382.910\n13438.558\n24827.304\n15815.642\n15927.3701\n31740.837\n129881.14\n118424.208\n248322.64\n0.8898330\n0.1614542\n0.5355726\n5.458098\n4.786378\n5.131399\n9.955561\n9.458904\n9.717781\n8.230412\n12.484661\n10.412578\n7.383439\n12.639283\n10.237363\n10.05031\n8.060183\n9.065779\n0.7553315\n0.1477702\n0.4713375\n1.532951\n2.455018\n1.848378\n1.950579\n2.1671029\n2.045911\n0.5968821\n0.8201907\n0.7168562\n0.1447444\n0.2493734\n0.2013441\n0.0834586\n0.0650708\n0.0742375\n0.5718412\n0.6116944\n0.5908073\nMULTIPOLYGON (((61.21082 35…\n\n\nAGO\n1246700.00\nAngola\nSub-Saharan Africa\n2015\n21.896669\n4.836927\n12.534813\n41.4338534\n11.1098732\n52.5437266\n199.14250\n50.657369\n249.79987\n450.26378\n97.05681\n547.32060\n449.18872\n120.05158\n569.24030\n132.296713\n39.7720635\n172.068776\n78.4143010\n21.644262\n100.058563\n1350.7399\n340.29196\n1691.0318\n1593522.83\n1631294.22\n3224817.0\n2322012.3\n2516729.4\n4838741.7\n2825202.9\n3162604.9\n5987807.8\n1196269.4\n1322735.7\n2519005.1\n179153.92\n222227.27\n401381.18\n66404.552\n94976.785\n161381.34\n12780032\n13553062\n26333094\n1574.60487\n1146.38596\n2720.35748\n4660.5425\n3557.05884\n8221.2432\n12770.1578\n12053.4901\n24813.5767\n20976.117\n14412.543\n35384.251\n9801.122\n7785.831\n17585.970\n8070.951\n8928.6120\n16997.980\n101271.46\n82739.779\n183941.00\n2.6001418\n0.6810466\n1.6293553\n8.576290\n2.012825\n5.162496\n15.937396\n3.068888\n9.140584\n37.549129\n9.076007\n22.597823\n73.845280\n17.897022\n42.869169\n118.08573\n22.789003\n62.001323\n2.6313810\n0.9691215\n1.9315008\n4.272947\n1.424136\n3.038468\n3.525906\n0.8052175\n2.205730\n2.1414294\n0.8329660\n1.6087391\n1.3498119\n0.5108262\n0.9784435\n0.9715621\n0.2424146\n0.5886497\n1.3337813\n0.4112798\n0.9193338\nMULTIPOLYGON (((16.32653 -5…\n\n\nALB\n27400.00\nAlbania\nEurope and Central Asia\n2015\n7.188618\n3.161862\n5.149327\n1.7506308\n1.0715855\n2.8222163\n21.31921\n12.872753\n34.19197\n39.47496\n13.84050\n53.31546\n30.35561\n12.56863\n42.92423\n8.659451\n3.3755519\n12.035003\n8.6248866\n5.742322\n14.367209\n110.1848\n49.47133\n159.6561\n101265.07\n91987.02\n193252.1\n245086.4\n230524.8\n475611.2\n352390.7\n355470.5\n707861.2\n355410.2\n368122.4\n723532.6\n104498.71\n105885.80\n210384.52\n65418.527\n80530.168\n145948.70\n1392936\n1385423\n2778359\n38.81143\n21.31527\n60.12015\n206.9370\n77.42318\n284.3179\n515.1111\n218.6979\n733.7353\n2040.983\n1063.180\n3104.372\n2665.265\n1577.458\n4243.934\n6015.928\n5743.9928\n11760.125\n11845.85\n8991.488\n20835.77\n1.7287608\n1.1649312\n1.4603808\n8.698651\n5.584109\n7.189059\n11.202043\n3.893571\n7.531908\n8.541006\n3.414252\n5.932592\n8.286658\n3.187917\n5.720479\n13.18417\n7.130647\n9.844013\n4.5106060\n5.0273140\n4.6942936\n10.302272\n16.626484\n12.025962\n7.663388\n6.3285897\n7.266307\n1.4873031\n1.1821731\n1.3827028\n0.3249003\n0.2139868\n0.2835813\n0.1433675\n0.0999709\n0.1221688\n0.9301552\n0.5502019\n0.7662597\nMULTIPOLYGON (((20.59025 41…\n\n\nARE\n71252.17\nUnited Arab Emirates\nMiddle East and North Africa\n2015\n6.499349\n2.693028\n5.491611\n0.5684426\n0.1590175\n0.7274601\n22.50879\n4.747960\n27.25675\n445.61060\n52.41087\n498.02148\n104.70366\n9.21879\n113.92245\n2.961838\n0.4379355\n3.399773\n0.8833814\n0.334826\n1.218208\n577.2367\n67.30940\n644.5461\n176956.74\n165408.04\n342364.8\n364914.3\n280777.3\n645691.6\n4632006.7\n1264106.1\n5896112.8\n985153.5\n275082.2\n1260235.8\n32506.25\n16190.27\n48696.52\n7941.803\n3613.348\n11555.15\n6633891\n2416386\n9050276\n57.63853\n30.38897\n88.03915\n385.1858\n118.56331\n503.7389\n8766.0655\n1236.2361\n10001.8532\n7465.451\n1541.173\n9007.562\n1196.180\n468.250\n1664.638\n831.633\n284.8243\n1116.562\n19008.94\n3930.387\n22937.21\n0.3212325\n0.0961365\n0.2124810\n6.168239\n1.691006\n4.221326\n9.620249\n4.146082\n8.446607\n10.628156\n3.351285\n9.039772\n9.111594\n2.704930\n6.981552\n11.12319\n9.266364\n10.542549\n0.9862198\n0.5232737\n0.8262916\n5.843617\n4.004578\n5.410888\n5.083359\n4.2395520\n4.979292\n1.4025094\n0.5981670\n1.2647423\n0.2476081\n0.0935260\n0.2042350\n0.1062225\n0.1175553\n0.1091034\n3.0366585\n1.7125388\n2.8100457\nMULTIPOLYGON (((51.57952 24…\n\n\nARG\n2736690.00\nArgentina\nLatin America and Caribbean\n2015\n17.484488\n3.937958\n10.374888\n32.6394303\n22.9966833\n55.6361137\n998.29883\n228.358908\n1226.65774\n1367.97052\n296.27335\n1664.24387\n807.08034\n238.43032\n1045.51066\n309.566482\n76.3241618\n385.890644\n323.0928166\n71.928794\n395.021611\n3838.6484\n934.31222\n4772.9606\n1788468.84\n1736840.65\n3525309.5\n3597003.9\n3569553.9\n7166557.8\n6194679.7\n6408778.6\n12603458.3\n4035560.8\n4361404.0\n8396964.8\n1207356.76\n1476178.41\n2683535.17\n739058.664\n1243389.111\n1982447.77\n21176169\n22286211\n43462380\n501.34827\n335.59106\n836.95218\n4531.6919\n1597.78527\n6129.4963\n10957.9685\n5950.9260\n16908.9387\n36612.816\n22000.843\n58613.340\n38867.303\n25540.271\n64407.621\n74269.595\n100652.9623\n174922.572\n171054.00\n160158.037\n331211.97\n1.8249929\n1.3240526\n1.5781909\n27.753621\n6.397407\n17.116415\n22.082991\n4.622930\n13.204660\n19.999212\n5.466825\n12.451054\n25.640017\n5.170389\n14.379936\n43.71680\n5.784898\n19.925953\n6.5103308\n6.8525913\n6.6474662\n22.029274\n14.292215\n20.012374\n12.483797\n4.9786093\n9.842391\n2.2043656\n1.0837326\n1.7837418\n0.7964702\n0.2988385\n0.5991382\n0.4350270\n0.0714622\n0.2258266\n2.2441150\n0.5833689\n1.4410592\nMULTIPOLYGON (((-65.5 -55.2…\n\n\nARM\n28470.00\nArmenia\nEurope and Central Asia\n2015\n14.098353\n3.512812\n8.351635\n0.8440151\n0.3055932\n1.1496084\n21.03323\n3.961647\n24.99488\n66.76874\n11.45912\n78.22787\n77.98008\n19.89774\n97.87781\n23.041570\n10.2959888\n33.337559\n38.8685190\n27.154958\n66.023477\n228.5362\n73.07505\n301.6112\n93148.89\n80295.95\n173444.8\n220963.5\n213838.0\n434801.5\n448679.9\n480271.1\n928951.0\n348881.2\n413358.7\n762239.9\n69967.05\n95614.11\n165581.16\n62546.628\n101615.609\n164162.24\n1470531\n1583486\n3054017\n22.88045\n13.82072\n36.70343\n160.1594\n50.14563\n210.3026\n736.8637\n308.9896\n1045.8305\n4141.364\n1992.081\n6133.363\n2550.600\n1938.685\n4489.208\n6360.953\n8907.8589\n15268.619\n14362.52\n13484.984\n27846.78\n0.9060925\n0.3805836\n0.6628092\n9.518873\n1.852639\n5.748572\n14.881152\n2.385970\n8.421097\n22.351470\n4.813673\n12.840815\n32.932030\n10.768273\n20.133667\n62.14327\n26.723215\n40.218431\n3.6888053\n2.2111241\n3.1321555\n13.132688\n7.900282\n11.885198\n9.061207\n3.7085787\n7.479975\n1.8829563\n0.9988418\n1.5958261\n0.9033783\n0.5310812\n0.7426156\n0.6110487\n0.3048427\n0.4324129\n1.5911985\n0.5418994\n1.0831098\nMULTIPOLYGON (((43.58275 41…\n\n\n\n\n\nTo illustrate mapping age-standardised suicide rate for both genders (SR_AS_T)\n\ntm_shape(suicidedata_eda_map) +\n    tm_polygons(\"SR_AS_T\")\n\n\n\n\nIgnore below\n#rworldmap - Example code below\n#https://cran.r-project.org/web/packages/rworldmap/vignettes/rworldmap.pdf\n\n#suicidedata_cln_map <- joinCountryData2Map(suicidedata_cln_region,\n#                                 joinCode = \"ISO3\",\n#                                 nameJoinColumn = \"code\")\n\n#Other References using typical world map - https://rpubs.com/Thom_JH/798825"
=======
    "text": "pacman::p_load(\"tmap\", \"tidyverse\")\n\n\n  There are binary versions available but the source versions are later:\n           binary source needs_compilation\ngeometries  0.2.1  0.2.2              TRUE\nclassInt    0.4-8  0.4-9              TRUE\n\n  Binaries will be installed\npackage 'Rcpp' successfully unpacked and MD5 sums checked\npackage 'wk' successfully unpacked and MD5 sums checked\npackage 'terra' successfully unpacked and MD5 sums checked\npackage 'geometries' successfully unpacked and MD5 sums checked\npackage 'jsonify' successfully unpacked and MD5 sums checked\npackage 'rapidjsonr' successfully unpacked and MD5 sums checked\npackage 'sfheaders' successfully unpacked and MD5 sums checked\npackage 'lwgeom' successfully unpacked and MD5 sums checked\npackage 'dichromat' successfully unpacked and MD5 sums checked\npackage 'XML' successfully unpacked and MD5 sums checked\npackage 's2' successfully unpacked and MD5 sums checked\npackage 'raster' successfully unpacked and MD5 sums checked\npackage 'sp' successfully unpacked and MD5 sums checked\npackage 'leaflet.providers' successfully unpacked and MD5 sums checked\npackage 'geojsonsf' successfully unpacked and MD5 sums checked\npackage 'tmaptools' successfully unpacked and MD5 sums checked\npackage 'sf' successfully unpacked and MD5 sums checked\npackage 'stars' successfully unpacked and MD5 sums checked\npackage 'units' successfully unpacked and MD5 sums checked\npackage 'classInt' successfully unpacked and MD5 sums checked\npackage 'widgetframe' successfully unpacked and MD5 sums checked\npackage 'leaflet' successfully unpacked and MD5 sums checked\npackage 'leafsync' successfully unpacked and MD5 sums checked\npackage 'leafem' successfully unpacked and MD5 sums checked\npackage 'tmap' successfully unpacked and MD5 sums checked\n\nThe downloaded binary packages are in\n    C:\\Users\\chanj\\AppData\\Local\\Temp\\Rtmp8Kbvyg\\downloaded_packages\n\n\n\n\n\n\nsuicidedata <- list.files(path = \"data\",\n                          pattern = \"IHME-GBD_2019_DATA\",\n                          full.names = TRUE) %>%\n  lapply(read_csv) %>%\n  bind_rows\n\nworld_region <- read_csv(\"data/world-regions-according-to-the-world-bank.csv\")\n\n\nstr(suicidedata)\n\nspc_tbl_ [2,864,160 × 16] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ measure_id   : num [1:2864160] 1 1 1 1 1 1 1 1 1 1 ...\n $ measure_name : chr [1:2864160] \"Deaths\" \"Deaths\" \"Deaths\" \"Deaths\" ...\n $ location_id  : num [1:2864160] 34 34 34 34 34 34 34 34 34 34 ...\n $ location_name: chr [1:2864160] \"Azerbaijan\" \"Azerbaijan\" \"Azerbaijan\" \"Azerbaijan\" ...\n $ sex_id       : num [1:2864160] 1 2 3 1 2 3 1 2 3 1 ...\n $ sex_name     : chr [1:2864160] \"Male\" \"Female\" \"Both\" \"Male\" ...\n $ age_id       : num [1:2864160] 7 7 7 7 7 7 7 7 7 8 ...\n $ age_name     : chr [1:2864160] \"10-14 years\" \"10-14 years\" \"10-14 years\" \"10-14 years\" ...\n $ cause_id     : num [1:2864160] 718 718 718 718 718 718 718 718 718 718 ...\n $ cause_name   : chr [1:2864160] \"Self-harm\" \"Self-harm\" \"Self-harm\" \"Self-harm\" ...\n $ metric_id    : num [1:2864160] 1 1 1 2 2 2 3 3 3 1 ...\n $ metric_name  : chr [1:2864160] \"Number\" \"Number\" \"Number\" \"Percent\" ...\n $ year         : num [1:2864160] 1990 1990 1990 1990 1990 1990 1990 1990 1990 1990 ...\n $ val          : num [1:2864160] 2.12717 0.73168 2.85886 0.00936 0.00519 ...\n $ upper        : num [1:2864160] 5.06912 1.12527 6.00823 0.02232 0.00788 ...\n $ lower        : num [1:2864160] 1.20028 0.46192 1.80284 0.00534 0.00324 ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   measure_id = col_double(),\n  ..   measure_name = col_character(),\n  ..   location_id = col_double(),\n  ..   location_name = col_character(),\n  ..   sex_id = col_double(),\n  ..   sex_name = col_character(),\n  ..   age_id = col_double(),\n  ..   age_name = col_character(),\n  ..   cause_id = col_double(),\n  ..   cause_name = col_character(),\n  ..   metric_id = col_double(),\n  ..   metric_name = col_character(),\n  ..   year = col_double(),\n  ..   val = col_double(),\n  ..   upper = col_double(),\n  ..   lower = col_double()\n  .. )\n - attr(*, \"problems\")=<externalptr> \n\n\n\n\n\n\nFilter for “Self-harm”\nSelect relevant columns and arrange rows based on location_name\nPivot_wider by metric_name (number, percent, and rate)\nCalculate the population size, death number and death rate\n\n\nsuicidedata_mod <- suicidedata %>%\n  filter(cause_name == \"Self-harm\") %>%\n  arrange(location_name) %>%\n  select(4,6,8,10,(12:14)) %>%\n  pivot_wider(names_from = metric_name, values_from = val, names_glue = \"suicide_{metric_name}\") %>%\n  mutate(population_size = suicide_Number/(suicide_Rate/100000),\n         death_number = suicide_Number/suicide_Percent,\n         death_rate = death_number/population_size*100000,\n         year = as.integer(year))\n\nsuicidedata_mod\n\n# A tibble: 330,480 × 11\n   locat…¹ sex_n…² age_n…³ cause…⁴  year suici…⁵ suici…⁶ suici…⁷ popul…⁸ death…⁹\n   <chr>   <chr>   <chr>   <chr>   <int>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n 1 Afghan… Male    10-14 … Self-h…  1991   10.5  0.00830   1.43   7.33e5   1260.\n 2 Afghan… Female  10-14 … Self-h…  1991    1.97 0.00174   0.281  7.02e5   1135.\n 3 Afghan… Both    10-14 … Self-h…  1991   12.4  0.00519   0.866  1.43e6   2395.\n 4 Afghan… Male    15-19 … Self-h…  1991   43.4  0.0194    5.49   7.91e5   2243.\n 5 Afghan… Female  15-19 … Self-h…  1991   36.2  0.0216    4.87   7.43e5   1675.\n 6 Afghan… Both    15-19 … Self-h…  1991   79.6  0.0203    5.19   1.53e6   3917.\n 7 Afghan… Male    20-24 … Self-h…  1991   60.9  0.0250    9.58   6.36e5   2432.\n 8 Afghan… Female  20-24 … Self-h…  1991   68.4  0.0320   10.7    6.41e5   2136.\n 9 Afghan… Both    20-24 … Self-h…  1991  129.   0.0283   10.1    1.28e6   4567.\n10 Afghan… Male    25-29 … Self-h…  1991   34.8  0.0246    9.57   3.64e5   1414.\n# … with 330,470 more rows, 1 more variable: death_rate <dbl>, and abbreviated\n#   variable names ¹​location_name, ²​sex_name, ³​age_name, ⁴​cause_name,\n#   ⁵​suicide_Number, ⁶​suicide_Percent, ⁷​suicide_Rate, ⁸​population_size,\n#   ⁹​death_number\n\n\n\n\n\ndata)\nIdentify key differences\n\nsuicide_vs_region <- setdiff(suicidedata_mod$location_name, world_region$Entity) %>%\n  enframe(name = NULL, value = \"desn\") %>% \n  arrange(desn)\n\n\n#the list of countries in suicidedata_clean but not in world_map\nsuicide_vs_region  %>% \n  knitr::kable(caption = \"Countries in suicide dataset vs. ISO3 regions: Coverage diff\",\n               row.names = TRUE)\n\n\nCountries in suicide dataset vs. ISO3 regions: Coverage diff\n\n\n\ndesn\n\n\n\n\n1\nBolivia (Plurinational State of)\n\n\n2\nBrunei Darussalam\n\n\n3\nCabo Verde\n\n\n4\nCôte d’Ivoire\n\n\n5\nDemocratic People’s Republic of Korea\n\n\n6\nDemocratic Republic of the Congo\n\n\n7\nIran (Islamic Republic of)\n\n\n8\nLao People’s Democratic Republic\n\n\n9\nMicronesia (Federated States of)\n\n\n10\nRepublic of Korea\n\n\n11\nRepublic of Moldova\n\n\n12\nRussian Federation\n\n\n13\nSyrian Arab Republic\n\n\n14\nTaiwan (Province of China)\n\n\n15\nTimor-Leste\n\n\n16\nUnited Republic of Tanzania\n\n\n17\nUnited States of America\n\n\n18\nVenezuela (Bolivarian Republic of)\n\n\n19\nViet Nam\n\n\n\n\n\n\n\nChange the names of countries to match the two datasets\n\nsuicidedata_cln_ctry <- suicidedata_mod %>%\n  rename(country = location_name) %>%\n  mutate(country = case_when(country == \"Bolivia (Plurinational State of)\" ~ \"Bolivia\",\n                             country == \"Brunei Darussalam\" ~ \"Brunei\",\n                             country == \"Cabo Verde\" ~ \"Cape Verde\",\n                             country == \"Côte d'Ivoire\" ~ \"Cote d'Ivoire\",\n                             country == \"Democratic People's Republic of Korea\" ~ \"North Korea\",\n                             country == \"Democratic Republic of the Congo\" ~ \"Democratic Republic of Congo\",\n                             country == \"Iran (Islamic Republic of)\" ~ \"Iran\",\n                             country == \"Lao People's Democratic Republic\" ~ \"Laos\",\n                             country == \"Micronesia (Federated States of)\" ~ \"Micronesia\",\n                             country == \"Republic of Korea\" ~ \"South Korea\",\n                             country == \"Republic of Moldova\" ~ \"Moldova\",\n                             country == \"Russian Federation\" ~ \"Russia\",\n                             country == \"Syrian Arab Republic\" ~ \"Syria\",\n                             country == \"Taiwan (Province of China)\" ~ \"Taiwan\",\n                             country == \"United Republic of Tanzania\" ~ \"Tanzania\",\n                             country == \"Venezuela (Bolivarian Republic of)\" ~ \"Venezuela\",\n                             country == \"Viet Nam\" ~ \"Vietnam\",\n                             TRUE ~ country))\n\nworld_region_cln <- world_region %>%\n  rename(country = Entity) %>%\n  mutate(country = case_when(country == \"Timor\" ~ \"Timor-Leste\",\n                             country == \"United States\" ~ \"United States of America\",\n                             TRUE~country))\n\n### Progress check\nsetdiff(suicidedata_cln_ctry$country, world_region_cln$country)  %>% \n  enframe(name = NULL, value = \"diff\") %>% \n  knitr::kable(caption = \"Remaining Cases\", \n               row.names = TRUE)\n\n\nRemaining Cases\n\n\n\ndiff\n\n\n\n\n\n\n\nJoining the two datasets\n\nsuicidedata_cln = suicidedata_cln_ctry %>%\n  left_join(world_region_cln, by = c('country' = 'country')) %>%\n  select(!Year) %>%\n  rename(code = Code,\n         region = World_RegionbyWorld_Bank) %>%\n  relocate(code:region, .after = country)\n\nsuicidedata_cln\n\n# A tibble: 330,480 × 13\n   country    code  region sex_n…¹ age_n…² cause…³  year suici…⁴ suici…⁵ suici…⁶\n   <chr>      <chr> <chr>  <chr>   <chr>   <chr>   <int>   <dbl>   <dbl>   <dbl>\n 1 Afghanist… AFG   South… Male    10-14 … Self-h…  1991   10.5  0.00830   1.43 \n 2 Afghanist… AFG   South… Female  10-14 … Self-h…  1991    1.97 0.00174   0.281\n 3 Afghanist… AFG   South… Both    10-14 … Self-h…  1991   12.4  0.00519   0.866\n 4 Afghanist… AFG   South… Male    15-19 … Self-h…  1991   43.4  0.0194    5.49 \n 5 Afghanist… AFG   South… Female  15-19 … Self-h…  1991   36.2  0.0216    4.87 \n 6 Afghanist… AFG   South… Both    15-19 … Self-h…  1991   79.6  0.0203    5.19 \n 7 Afghanist… AFG   South… Male    20-24 … Self-h…  1991   60.9  0.0250    9.58 \n 8 Afghanist… AFG   South… Female  20-24 … Self-h…  1991   68.4  0.0320   10.7  \n 9 Afghanist… AFG   South… Both    20-24 … Self-h…  1991  129.   0.0283   10.1  \n10 Afghanist… AFG   South… Male    25-29 … Self-h…  1991   34.8  0.0246    9.57 \n# … with 330,470 more rows, 3 more variables: population_size <dbl>,\n#   death_number <dbl>, death_rate <dbl>, and abbreviated variable names\n#   ¹​sex_name, ²​age_name, ³​cause_name, ⁴​suicide_Number, ⁵​suicide_Percent,\n#   ⁶​suicide_Rate\n\n\n\n\n\n\nRisk Factors of Suicide\n\n\n\nRisk Factors of Suicide\n\n\n\n\n\nsuicidedata_age_std <- suicidedata_cln %>%\n  filter(age_name == \"Age-standardized\") %>%\n  pivot_wider(names_from = sex_name,\n              values_from = suicide_Rate) %>%\n  select(c(1,2,3,6,12,13,14)) %>%\n  rename(\"SR_AS_T\" = \"Both\",\n         \"SR_AS_M\" = \"Male\",\n         \"SR_AS_F\" = \"Female\")\n\n\n\n\n\n\nSource for division https://www.ncbi.nlm.nih.gov/books/NBK470850/figure/SR-240_RB-3370.fig08/\n\n10 to 14\n15 to 24\n25 to 44\n45 to 64\n65 to 74\n75+\n\n\nsuicide_number_age <- suicidedata_cln %>%\n  filter(!age_name %in% c(\"Age-standardized\")) %>%\n  select(c(2,4,5,7,8)) %>%\n  mutate(age_name = str_remove(age_name, \" years\"),\n         age_name = str_remove(age_name, \" ages\"),\n         sex_name = case_when(sex_name == \"Male\" ~ \"M\",\n                              sex_name == \"Female\" ~ \"F\",\n                              sex_name == \"Both\" ~ \"T\",\n                              TRUE ~ sex_name)) %>%\n  pivot_wider(names_from = c(age_name, sex_name),\n              names_prefix = \"SN_\",\n              values_from = suicide_Number) %>%\n  mutate(`SN_15-24_M` = `SN_15-19_M`+`SN_20-24_M`,\n         `SN_15-24_F` = `SN_15-19_F`+`SN_20-24_F`,\n         `SN_15-24_T` = `SN_15-19_T`+`SN_20-24_T`,\n         `SN_25-44_M` = `SN_25-29_M`+`SN_30-34_M`+`SN_35-39_M`+`SN_40-44_M`,\n         `SN_25-44_F` = `SN_25-29_F`+`SN_30-34_F`+`SN_35-39_F`+`SN_40-44_F`,\n         `SN_25-44_T` = `SN_25-29_T`+`SN_30-34_T`+`SN_35-39_T`+`SN_40-44_T`,\n         `SN_45-64_M` = `SN_45-49_M`+`SN_50-54_M`+`SN_55-59_M`+`SN_60-64_M`,\n         `SN_45-64_F` = `SN_45-49_F`+`SN_50-54_F`+`SN_55-59_F`+`SN_60-64_F`,\n         `SN_45-64_T` = `SN_45-49_T`+`SN_50-54_T`+`SN_55-59_T`+`SN_60-64_T`,\n         `SN_65-74_M` = `SN_65-69_M`+`SN_70-74_M`,\n         `SN_65-74_F` = `SN_65-69_F`+`SN_70-74_F`,\n         `SN_65-74_T` = `SN_65-69_T`+`SN_70-74_T`,\n         `SN_75+_M` = `SN_75-79_M`+`SN_80-84_M`+`SN_85+_M`,\n         `SN_75+_F` = `SN_75-79_F`+`SN_80-84_F`+`SN_85+_F`,\n         `SN_75+_T` = `SN_75-79_T`+`SN_80-84_T`+`SN_85+_T`) %>%\n  select(code:`SN_10-14_T`, `SN_15-24_M`:`SN_75+_T`, `SN_All_M`:`SN_All_T`)\n\n\n#suicide_number_age <- suicidedata_cln %>%\n#  filter(sex_name == \"Both\",\n#         !age_name %in% c(\"All ages\", \"Age-standardized\")) %>%\n#  select(c(2,5,7,8)) %>%\n#  pivot_wider(names_from = age_name,\n#              values_from = suicide_Number) %>%\n#  mutate(young_SN = rowSums(.[3:5]),\n#         econ_active_SN = rowSums(.[6:13]),\n#         aged_SN = rowSums(.[14:18]),\n#         total_SN = young_SN+econ_active_SN+aged_SN) %>%\n#  select(c(1,2,19,20,21,22))\n\n\n\n\n\npop_size_age <- suicidedata_cln %>%\n  filter(!age_name %in% c(\"Age-standardized\")) %>%\n  select(c(2,4,5,7,11)) %>%\n  mutate(age_name = str_remove(age_name, \" years\"),\n         age_name = str_remove(age_name, \" ages\"),\n         sex_name = case_when(sex_name == \"Male\" ~ \"M\",\n                              sex_name == \"Female\" ~ \"F\",\n                              sex_name == \"Both\" ~ \"T\",\n                              TRUE ~ sex_name)) %>%\n  pivot_wider(names_from = c(age_name, sex_name),\n              names_prefix = \"POP_\",\n              values_from = population_size) %>%\n  mutate(`POP_15-24_M` = `POP_15-19_M`+`POP_20-24_M`,\n         `POP_15-24_F` = `POP_15-19_F`+`POP_20-24_F`,\n         `POP_15-24_T` = `POP_15-19_T`+`POP_20-24_T`,\n         `POP_25-44_M` = `POP_25-29_M`+`POP_30-34_M`+`POP_35-39_M`+`POP_40-44_M`,\n         `POP_25-44_F` = `POP_25-29_F`+`POP_30-34_F`+`POP_35-39_F`+`POP_40-44_F`,\n         `POP_25-44_T` = `POP_25-29_T`+`POP_30-34_T`+`POP_35-39_T`+`POP_40-44_T`,\n         `POP_45-64_M` = `POP_45-49_M`+`POP_50-54_M`+`POP_55-59_M`+`POP_60-64_M`,\n         `POP_45-64_F` = `POP_45-49_F`+`POP_50-54_F`+`POP_55-59_F`+`POP_60-64_F`,\n         `POP_45-64_T` = `POP_45-49_T`+`POP_50-54_T`+`POP_55-59_T`+`POP_60-64_T`,\n         `POP_65-74_M` = `POP_65-69_M`+`POP_70-74_M`,\n         `POP_65-74_F` = `POP_65-69_F`+`POP_70-74_F`,\n         `POP_65-74_T` = `POP_65-69_T`+`POP_70-74_T`,\n         `POP_75+_M` = `POP_75-79_M`+`POP_80-84_M`+`POP_85+_M`,\n         `POP_75+_F` = `POP_75-79_F`+`POP_80-84_F`+`POP_85+_F`,\n         `POP_75+_T` = `POP_75-79_T`+`POP_80-84_T`+`POP_85+_T`) %>%\n  select(code:`POP_10-14_T`, `POP_15-24_M`:`POP_75+_T`, `POP_All_M`:`POP_All_T`)\n\n\n#pop_size_age <- suicidedata_cln %>%\n#  filter(sex_name == \"Both\",\n#         !age_name %in% c(\"All ages\", \"Age-standardized\")) %>%\n#  select(c(2,5,7,11)) %>%\n#  pivot_wider(names_from = age_name,\n#              values_from = population_size) %>%\n#  mutate(young_pop = rowSums(.[3:5]),\n#         econ_active_pop = rowSums(.[6:13]),\n#         aged_pop = rowSums(.[14:18]),\n#         total_pop = young_pop+econ_active_pop+aged_pop) %>%\n#  select(c(1,2,19,20,21,22))\n\n\n\n\n\ndeath_number_age <- suicidedata_cln %>%\n  filter(!age_name %in% c(\"Age-standardized\")) %>%\n  select(c(2,4,5,7,12)) %>%\n  mutate(age_name = str_remove(age_name, \" years\"),\n         age_name = str_remove(age_name, \" ages\"),\n         sex_name = case_when(sex_name == \"Male\" ~ \"M\",\n                              sex_name == \"Female\" ~ \"F\",\n                              sex_name == \"Both\" ~ \"T\",\n                              TRUE ~ sex_name)) %>%\n  pivot_wider(names_from = c(age_name, sex_name),\n              names_prefix = \"DN_\",\n              values_from = death_number) %>%\n  mutate(`DN_15-24_M` = `DN_15-19_M`+`DN_20-24_M`,\n         `DN_15-24_F` = `DN_15-19_F`+`DN_20-24_F`,\n         `DN_15-24_T` = `DN_15-19_T`+`DN_20-24_T`,\n         `DN_25-44_M` = `DN_25-29_M`+`DN_30-34_M`+`DN_35-39_M`+`DN_40-44_M`,\n         `DN_25-44_F` = `DN_25-29_F`+`DN_30-34_F`+`DN_35-39_F`+`DN_40-44_F`,\n         `DN_25-44_T` = `DN_25-29_T`+`DN_30-34_T`+`DN_35-39_T`+`DN_40-44_T`,\n         `DN_45-64_M` = `DN_45-49_M`+`DN_50-54_M`+`DN_55-59_M`+`DN_60-64_M`,\n         `DN_45-64_F` = `DN_45-49_F`+`DN_50-54_F`+`DN_55-59_F`+`DN_60-64_F`,\n         `DN_45-64_T` = `DN_45-49_T`+`DN_50-54_T`+`DN_55-59_T`+`DN_60-64_T`,\n         `DN_65-74_M` = `DN_65-69_M`+`DN_70-74_M`,\n         `DN_65-74_F` = `DN_65-69_F`+`DN_70-74_F`,\n         `DN_65-74_T` = `DN_65-69_T`+`DN_70-74_T`,\n         `DN_75+_M` = `DN_75-79_M`+`DN_80-84_M`+`DN_85+_M`,\n         `DN_75+_F` = `DN_75-79_F`+`DN_80-84_F`+`DN_85+_F`,\n         `DN_75+_T` = `DN_75-79_T`+`DN_80-84_T`+`DN_85+_T`) %>%\n  select(code:`DN_10-14_T`, `DN_15-24_M`:`DN_75+_T`, `DN_All_M`:`DN_All_T`)\n\n\n\n\n\nReference - https://ourworldindata.org/grapher/gdp-per-capita-worldbank?tab=chart\n\ngdp_per_capita <- read_csv(\"data/gdp-per-capita-worldbank.csv\")\n\n\ngdp_per_capita <- gdp_per_capita %>%\n  select(2,3,4) %>%\n  rename(\"code\" = \"Code\",\n         \"year\" = \"Year\",\n         \"gdp_per_capita\" = \"GDP per capita, PPP (constant 2017 international $)\") %>%\n  na.omit()\n\n\n\n\nReference - https://ourworldindata.org/grapher/human-development-index\n\nhdi <- read_csv(\"data/human-development-index.csv\")\n\n\nhdi <- hdi %>%\n  select(2,3,4) %>%\n  rename(\"code\" = \"Code\",\n         \"year\" = \"Year\",\n         \"hdi\" = \"Human Development Index\") %>%\n  na.omit()\n\n\n\n\nReference - https://ourworldindata.org/grapher/suicide-rates-vs-prevalence-of-depression\n\ndepr <- read_csv(\"data/suicide-rates-vs-prevalence-of-depression.csv\")\n\n\ndepr <- depr %>%\n  select(2,3,5) %>%\n  rename(\"code\" = \"Code\",\n         \"year\" = \"Year\",\n         \"depr_rate\" = \"Prevalence - Depressive disorders - Sex: Both - Age: Age-standardized (Rate)\") %>%\n  filter(year %in% (1990:2019)) %>%\n  na.omit()\n\n\n\n\nReference - https://ourworldindata.org/grapher/suicide-rate-vs-income-inequality\n\ngini <- read_csv(\"data/suicide-rate-vs-income-inequality.csv\")\n\n\ngini <- gini %>%\n  select(2,3,5) %>%\n  rename(\"code\" = \"Code\",\n         \"year\" = \"Year\",\n         \"gini\" = \"Gini coefficient\") %>%\n  filter(year %in% (1990:2019)) %>%\n  na.omit()\n\n\n\n\nReference - https://ourworldindata.org/grapher/suicide-vs-violent-deaths\n\nviolent <- read_csv(\"data/suicide-vs-violent-deaths.csv\")\n\n\nviolent <- violent %>%\n  select(2,3,5) %>%\n  rename(\"code\" = \"Code\",\n         \"year\" = \"Year\",\n         \"violent_death_rate\" = \"Deaths - All forms of violence - OWID - Sex: Both - Age: Age-standardized (Rate)\") %>%\n  filter(year %in% (1990:2019)) %>%\n  na.omit()\n\n\n\n\nReference - https://ourworldindata.org/grapher/share-of-population-in-extreme-poverty?country=BGD~BOL~MDG~IND~CHN~ETH\n\npoverty <- read_csv(\"data/share-of-population-in-extreme-poverty.csv\")\n\n\npoverty <- poverty %>%\n  select(2,3,4) %>%\n  rename(\"code\" = \"Code\",\n         \"year\" = \"Year\",\n         \"pop%extreme_poverty\" = \"$2.15 a day - share of population below poverty line\") %>%\n  filter(year %in% (1990:2019)) %>%\n  na.omit()\n\n\n\n\nReference - https://ourworldindata.org/grapher/unemployment-rate?time=latest\n\nunemployment <- read_csv(\"data/unemployment-rate.csv\")\n\n\nunemployment <- unemployment %>%\n  select(2,3,4) %>%\n  rename(\"code\" = \"Code\",\n         \"year\" = \"Year\",\n         \"unemployment_rate\" = \"Unemployment, total (% of total labor force) (modeled ILO estimate)\") %>%\n  filter(year %in% (1990:2019)) %>%\n  na.omit()\n\n\n\n\nReference - https://ourworldindata.org/grapher/haq-by-level-of-healthcare-spending-endpoints?time=earliest\n\nhealthcare <- read_csv(\"data/HAQ-by-level-of-healthcare-spending-endpoints.csv\")\n\n\nhealthcare <- healthcare %>%\n  select(2,3,4,5) %>%\n  rename(\"code\" = \"Code\",\n         \"year\" = \"Year\",\n         \"HAQ\" = \"HAQ Index (IHME (2017))\",\n         \"healthcare_spend\" = \"Current health expenditure per capita, PPP (current international $)\") %>%\n  filter(year %in% (1990:2019)) %>%\n  filter(!is.na(HAQ) | !is.na(healthcare_spend))\n\n\n\n\nReference - https://ourworldindata.org/grapher/happiness-cantril-ladder?time=latest\n\nhappiness <- read_csv(\"data/happiness-cantril-ladder.csv\")\n\n\nhappiness <- happiness %>%\n  select(2,3,4) %>%\n  rename(\"code\" = \"Code\",\n         \"year\" = \"Year\",\n         \"happiness\" = \"Life satisfaction in Cantril Ladder (World Happiness Report 2022)\") %>%\n  filter(year %in% (1990:2019)) %>%\n  na.omit()\n\n\n\n\nReference - https://ourworldindata.org/grapher/suicide-rates-vs-prevalence-of-mental-and-substance-use-disorders?time=latest\n\nmental <- read_csv(\"data/suicide-rates-vs-prevalence-of-mental-and-substance-use-disorders.csv\")\n\n\nmental <- mental %>%\n  select(2,3,5) %>%\n  rename(\"code\" = \"Code\",\n         \"year\" = \"Year\",\n         \"mental_disorder\" = \"Prevalence - Mental and substance use disorders - Sex: Both - Age: Age-standardized (Rate)\") %>%\n  filter(year %in% (1990:2019)) %>%\n  na.omit()\n\nFEEL FREE TO ADD SOMEMORE\n\n\n\n\nsuicidedata_eda <- left_join(suicidedata_age_std, suicide_number_age, by = c('code' = 'code', 'year' = 'year')) %>% \n  \n  left_join(., pop_size_age, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  left_join(., death_number_age, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  #calculate suicide rate for each age group and gender\n  #Use Age Standardised for all age metrics\n  mutate(`SR_10-14_M` = `SN_10-14_M`*100000/`POP_10-14_M`,\n         `SR_10-14_F` = `SN_10-14_F`*100000/`POP_10-14_F`,\n         `SR_10-14_T` = `SN_10-14_T`*100000/`POP_10-14_T`,\n         `SR_15-24_M` = `SN_15-24_M`*100000/`POP_15-24_M`,\n         `SR_15-24_F` = `SN_15-24_F`*100000/`POP_15-24_F`,\n         `SR_15-24_T` = `SN_15-24_T`*100000/`POP_15-24_T`,\n         `SR_25-44_M` = `SN_25-44_M`*100000/`POP_25-44_M`,\n         `SR_25-44_F` = `SN_25-44_F`*100000/`POP_25-44_F`,\n         `SR_25-44_T` = `SN_25-44_T`*100000/`POP_25-44_T`,\n         `SR_45-64_M` = `SN_45-64_M`*100000/`POP_45-64_M`,\n         `SR_45-64_F` = `SN_45-64_F`*100000/`POP_45-64_F`,\n         `SR_45-64_T` = `SN_45-64_T`*100000/`POP_45-64_T`,\n         `SR_65-74_M` = `SN_65-74_M`*100000/`POP_65-74_M`,\n         `SR_65-74_F` = `SN_65-74_F`*100000/`POP_65-74_F`,\n         `SR_65-74_T` = `SN_65-74_T`*100000/`POP_65-74_T`,\n         `SR_75+_M` = `SN_75+_M`*100000/`POP_75+_M`,\n         `SR_75+_F` = `SN_75+_F`*100000/`POP_75+_F`,\n         `SR_75+_T` = `SN_75+_T`*100000/`POP_75+_T`) %>%\n    \n  #calculate suicide percent for each age group and gender\n    mutate(`SP_10-14_M` = `SN_10-14_M`*100/`DN_10-14_M`,\n         `SP_10-14_F` = `SN_10-14_F`*100/`DN_10-14_F`,\n         `SP_10-14_T` = `SN_10-14_T`*100/`DN_10-14_T`,\n         `SP_15-24_M` = `SN_15-24_M`*100/`DN_15-24_M`,\n         `SP_15-24_F` = `SN_15-24_F`*100/`DN_15-24_F`,\n         `SP_15-24_T` = `SN_15-24_T`*100/`DN_15-24_T`,\n         `SP_25-44_M` = `SN_25-44_M`*100/`DN_25-44_M`,\n         `SP_25-44_F` = `SN_25-44_F`*100/`DN_25-44_F`,\n         `SP_25-44_T` = `SN_25-44_T`*100/`DN_25-44_T`,\n         `SP_45-64_M` = `SN_45-64_M`*100/`DN_45-64_M`,\n         `SP_45-64_F` = `SN_45-64_F`*100/`DN_45-64_F`,\n         `SP_45-64_T` = `SN_45-64_T`*100/`DN_45-64_T`,\n         `SP_65-74_M` = `SN_65-74_M`*100/`DN_65-74_M`,\n         `SP_65-74_F` = `SN_65-74_F`*100/`DN_65-74_F`,\n         `SP_65-74_T` = `SN_65-74_T`*100/`DN_65-74_T`,\n         `SP_75+_M` = `SN_75+_M`*100/`DN_75+_M`,\n         `SP_75+_F` = `SN_75+_F`*100/`DN_75+_F`,\n         `SP_75+_T` = `SN_75+_T`*100/`DN_75+_T`,\n         `SP_All_M` = `SN_All_M`*100/`DN_All_M`,\n         `SP_All_F` = `SN_All_F`*100/`DN_All_F`,\n         `SP_All_T` = `SN_All_T`*100/`DN_All_T`) %>%\n  \n   arrange(code, year)\n\n\n\n\nFor analysis, we will only use suicide rate (SR)\n\nsuicidedata_analysis <- left_join(suicidedata_eda %>%\n                                    select(country:`SR_AS_T`, `SR_10-14_M`:`SR_75+_T`,`POP_All_T`)\n                                    , gdp_per_capita, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  left_join(., hdi, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  left_join(., depr, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  left_join(., gini, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  left_join(., violent, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  left_join(., poverty, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  left_join(., unemployment, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  left_join(., healthcare, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  left_join(., happiness, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  left_join(., mental, by = c('code' = 'code', 'year' = 'year')) %>%\n  \n  arrange(code, year) %>%\n  \n  #infer HAQ data from previous survey year\n  group_by(code) %>%\n  fill(HAQ, .direction = \"down\") %>%\n  ungroup()\n\nknitr::kable(head(suicidedata_analysis))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ncountry\ncode\nregion\nyear\nSR_AS_M\nSR_AS_F\nSR_AS_T\nSR_10-14_M\nSR_10-14_F\nSR_10-14_T\nSR_15-24_M\nSR_15-24_F\nSR_15-24_T\nSR_25-44_M\nSR_25-44_F\nSR_25-44_T\nSR_45-64_M\nSR_45-64_F\nSR_45-64_T\nSR_65-74_M\nSR_65-74_F\nSR_65-74_T\nSR_75+_M\nSR_75+_F\nSR_75+_T\nPOP_All_T\ngdp_per_capita\nhdi\ndepr_rate\ngini\nviolent_death_rate\npop%extreme_poverty\nunemployment_rate\nHAQ\nhealthcare_spend\nhappiness\nmental_disorder\n\n\n\n\nAfghanistan\nAFG\nSouth Asia\n1990\n7.473870\n9.049445\n8.277699\n1.436904\n0.2845199\n0.8702862\n7.337760\n7.442836\n7.390589\n11.84758\n13.55788\n12.81545\n9.968172\n15.64862\n12.83096\n8.814404\n14.67018\n11.49686\n11.24017\n8.766798\n10.111531\n11418853\nNA\n0.273\n4996.12\nNA\n29.79\nNA\nNA\n24.7\nNA\nNA\n17415.21\n\n\nAfghanistan\nAFG\nSouth Asia\n1991\n7.365818\n8.956768\n8.174310\n1.426575\n0.2809178\n0.8663718\n7.312539\n7.557676\n7.433210\n11.48811\n13.40145\n12.55289\n9.861825\n15.51690\n12.72240\n8.700137\n14.54045\n11.37474\n11.10952\n8.685643\n10.000869\n12587130\nNA\n0.279\n4989.29\nNA\n46.43\nNA\n10.649\n24.7\nNA\nNA\n17691.57\n\n\nAfghanistan\nAFG\nSouth Asia\n1992\n7.311281\n8.949483\n8.139174\n1.441334\n0.2823200\n0.8783460\n7.416693\n7.846135\n7.622235\n11.18181\n13.34959\n12.35099\n9.815580\n15.51857\n12.71511\n8.642180\n14.52574\n11.33208\n11.03810\n8.651869\n9.944729\n14542839\nNA\n0.287\n4981.35\nNA\n48.07\nNA\n10.821\n24.7\nNA\nNA\n17939.24\n\n\nAfghanistan\nAFG\nSouth Asia\n1993\n7.367846\n9.075284\n8.231295\n1.456090\n0.2827438\n0.8880330\n7.619946\n8.151316\n7.870469\n11.12268\n13.50517\n12.37492\n9.906709\n15.74727\n12.90513\n8.680089\n14.64145\n11.40769\n11.03904\n8.672698\n9.953116\n15985046\nNA\n0.297\n4976.96\nNA\n43.19\nNA\n10.723\n24.7\nNA\nNA\n18134.24\n\n\nAfghanistan\nAFG\nSouth Asia\n1994\n7.476588\n9.215872\n8.362751\n1.450883\n0.2767099\n0.8828732\n7.800166\n8.235269\n8.004561\n11.22814\n13.68922\n12.49976\n10.066832\n16.05810\n13.19583\n8.767587\n14.81558\n11.54394\n11.08710\n8.707214\n9.993162\n16733617\nNA\n0.292\n4977.78\nNA\n71.25\nNA\n10.726\n24.7\nNA\nNA\n18261.32\n\n\nAfghanistan\nAFG\nSouth Asia\n1995\n7.511729\n9.265633\n8.408568\n1.424181\n0.2675633\n0.8648144\n7.869979\n8.231410\n8.039101\n11.25371\n13.73564\n12.52419\n10.094794\n16.18774\n13.29331\n8.786471\n14.90617\n11.60844\n11.06250\n8.696033\n9.971134\n17490181\nNA\n0.310\n4978.23\nNA\n50.07\nNA\n11.179\n24.5\nNA\nNA\n18309.33\n\n\n\n\n\n\n\n\n\nThe object World is a spatial object of class sf from the sf package; it is a data.frame with a special column that contains a geometry for each row, in this case polygons\nReference - https://cran.r-project.org/web/packages/tmap/vignettes/tmap-getstarted.html\n\ndata(\"World\")\n\nJoining the two dataframes together\n\nsuicidedata_eda_map <- left_join(World, \n                                  \n                                  #filter year 2015 for illustration\n                                   suicidedata_eda %>% filter(year==2015),\n                          by = c(\"iso_a3\" = \"code\")) %>%\n  select(!c(2,3,4,6,7,8,9,10,11,12,13,14,15)) %>%\n  mutate(area = as.numeric(str_remove(`area`, \n                                \" \\\\[km\\\\^2\\\\]\")), \n         .after = region)\n\nTo illustrate mapping age-standardised suicide rate for both genders (SR_AS_T)\n\ntm_shape(suicidedata_eda_map) +\n    tm_polygons(\"SR_AS_T\")\n\n\n\n\nIgnore below\n#rworldmap - Example code below\n#https://cran.r-project.org/web/packages/rworldmap/vignettes/rworldmap.pdf\n\n#suicidedata_cln_map <- joinCountryData2Map(suicidedata_cln_region,\n#                                 joinCode = \"ISO3\",\n#                                 nameJoinColumn = \"code\")\n\n#Other References using typical world map - https://rpubs.com/Thom_JH/798825"
>>>>>>> 6574cabbc314d15253c5e61f07566cb7f0a61172
  }
]